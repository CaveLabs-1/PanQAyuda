{% extends "base.html" %}
{% block title %}Mermas Paquetes{% endblock title %}
{% block navbar %}{% include "navbar.html" %}{% endblock navbar %}
{% block header %}
  <header class="banner-prueba">
    {# buscar clase banner-prueba en main.css #}
    <h1 class="center-align">Mermas Paquetes</h1>
  </header>
{% endblock header %}
{% block content %}
{# ----------  Inicia modal  --------------  #}
<div id="agregarMermaPaquete" class="modal">
  <div class="modal-content">
    <div class="row valign-wrapper">
      <div class="col s7">
        <h4>Agregar Merma Paquetes</h4>
      </div>
      <div class="col s1 offset-s4">
        <a class="black-text modal-close">
          <i class="medium material-icons">close</i>
        </a>
      </div>
    </div>
    <form class="row" method="post" action="{% url 'mermas:agregar_merma_paquetes' %}">
      {% csrf_token %}
      <div class="input-field col s6">
        <select name="paquetes_catalogo" id="paquetes_catalogo">
          <option value="" selected="">---------</option>
          {% for paquete in paquetes_catalogo %}
            <option value="{{paquete.id}}">{{paquete.nombre}}</option>
          {% endfor %}
        </select>
        <label for="paquetes_catalogo">Producto terminado</label>
      </div>
      <div class="input-field col s6">
        <select name="nombre" required="" id="id_nombre">
          <option value="" selected="">---------</option>
        </select>
        <label for="nombre">Lote</label>
      </div>
      <div class="input-field col s6">
        <label for="{{forma.cantidad.id_for_label}}">Cantidad</label>
        <input id="{{forma.cantidad.id_for_label}}" name="{{forma.cantidad.html_name}}" type="number" required>
      </div>
      <div class="row">
        <div class="input-field col s12">
          <input class="datepicker" id="{{forma.fecha.id_for_label}}" type="text" class="required" name="{{forma.fecha.html_name}}" required>
          <label for="{{forma.fecha_fin.id_for_label}}">Fecha</label>
        </div>
      </div>
      <div class="row">
        <div class="input-field col s12">
          <label for="{{forma.descripcion.id_for_label}}">Descripcion</label>
          <input id="{{forma.descripcion.id_for_label}}" class="required" name="{{forma.descripcion.html_name}}" type="text" required>
        </div>
      </div>
      <div class="row">
        <div class="col s12 right-align">
          <br>
          <button type="submit" class="btn pink waves-effect waves-light">Agregar</button>
        </div>
      </div>
    </form>
  </div>
</div>
{# ----------  Termina modal  --------------  #}

<div class="row">
  <div class="col s12">
    <ul class="tabs">
      <li class="tab col s4"><a class="pink-text" href="/mermas/lista_mermas_receta/">Receta</a></li>
      <li class="tab col s4"><a class="white-text active" href="/mermas/lista_mermas/">Paquete</a></li>
      <li class="tab col s4"><a class="pink-text" href="/mermas/lista_mermas_material/">Material</a></li>
    </ul>
  </div>
</div>
  <div class="container">
    <!-- Carga donde carga todo -->
      <table id="table_id">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Cantidad</th>
              <th>Descripcion</th>
              <th>Fecha</th>
            </tr>
          </thead>
          <tbody>
            {% for merma in mermas %}
            <tr>
                <td>{{ merma.nombre }}</td>
                <td>{{ merma.cantidad }}</td>
                <td>{{ merma.descripcion }}</td>
                <td>{{ merma.fecha }}</td>
            </tr>
            {% endfor %}
          </tbody>
      </table>
      <br>
      <div class="row">
        <div class="right-align">
          <a href="#agregarMermaPaquete" class="btn-floating btn-large waves-effect waves-light pink modal-trigger"><i class="material-icons">add</i></a>
        </div>
      </div>
  </div>
{% endblock content %}
{% block js %}
  <script type="text/javascript">
    $(document).ready(function(){
      $('.collapsible').collapsible();

      $('#paquetes_catalogo').change(function(){
          var paquete_catalogo = $('#paquetes_catalogo').val();
          $.ajax({
                url: "{% url 'mermas:obtener_paquetes_ajuste_inventario' %}",
                data: {'id_paquete_catalogo': paquete_catalogo},
                success: function(response){
                   $('#id_nombre').html(response);
                   $('select').formSelect();
                },
          });
      });
    });
  </script>
{% endblock js %}
